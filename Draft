import sqlite3

def display_cities():
    conn = sqlite3.connect('cities.db')
    cursor = conn.cursor()

    while True:
        print("\nSelect an operation:")
        print("1. Display cities sorted by population (ascending)")
        print("2. Display cities sorted by population (descending)")
        print("3. Display cities sorted by name")
        print("4. Display total population")
        print("5. Display average population")
        print("6. Display city with the highest population")
        print("7. Display city with the lowest population")
        print("8. Exit")

        choice = input("Enter your choice: ")

        if choice == '1':
            cursor.execute('SELECT * FROM Cities ORDER BY Population ASC')
        elif choice == '2':
            cursor.execute('SELECT * FROM Cities ORDER BY Population DESC')
        elif choice == '3':
            cursor.execute('SELECT * FROM Cities ORDER BY CityName')
        elif choice == '4':
            cursor.execute('SELECT SUM(Population) FROM Cities')
            print("Total population:", cursor.fetchone()[0])
            continue
        elif choice == '5':
            cursor.execute('SELECT AVG(Population) FROM Cities')
            print("Average population:", cursor.fetchone()[0])
            continue
        elif choice == '6':
            cursor.execute('SELECT * FROM Cities ORDER BY Population DESC LIMIT 1')
        elif choice == '7':
            cursor.execute('SELECT * FROM Cities ORDER BY Population ASC LIMIT 1')
        elif choice == '8':
            break
        else:
            print("Invalid choice, try again.")
            continue

        results = cursor.fetchall()
        for row in results:
            print(row)

    conn.close()

display_cities()
